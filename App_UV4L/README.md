# UV4L을 이용한 영상 스트리밍 Android App 상세 설명
라즈베리파이에서 위험 구역에 반려 동물 진입 시 사용자 앱으로 알림을 전송합니다.<br>
앱 알림은 Firebase로 구현되어 있습니다.<br>
실시간 스트리밍 기능은 UV4L로 구현되어 있습니다.<br>
이 앱을 실행시키기 위한 상세 작업은 다음과 같습니다. <br>
<br>

## 라즈베리파이에서 수행해줘야 할 작업
라즈베리파이에서 UV4L 스트리밍을 실행하기 위해서는 이 레포지토리의 raspberrypi 폴더를 다운받은 뒤 다음과 같은 절차를 따릅니다.<br>
```
$ sudo service uv4l_raspicam restart (서비스 실행하기)
```
UV4L이 실행되면, 웹브라우저로 http://192.168.137.150:8080/ 에 접속합니다.<br>
Settings에서 픽셀을 가로 : 320, 세로 : 256로 맞춰줍니다. 안드로이드 앱 내에서 적절한 화면 크기를 유지하기 위해서입니다.<br>
MJPEGStills stream을 누르면 웹브라우저에서 파이캠의 영상 스트리밍이 시작됩니다.<br>
실행중인 프로세스를 죽일때는 다음과 같은 명령어를 사용합니다.<br>
```
pkill uv4l
```
<br>

## 안드로이드 스튜디오에서 수행해줘야 할 작업
```
webView.loadUrl("http://라즈베리파이의ip:8080/stream");
```
이부분에 본인의 라즈베리파이의 ip주소를 쓴 뒤 빌드합니다.<br>
라즈베리파이의 ip주소는 ifconfig로 확인할 수 있습니다.<br>
<br>

## 구독 정보 관리
이름, 이메일을 입력하고 "알림을 받겠습니다"를 체크 후, "구독합니다"버튼을 누르면 실시간 알림이 앱으로 전송됩니다.<br>
"해지합니다"버튼을 누르면 실시간 알림 기능이 취소됩니다.<br>
구독을 누른 사용자의 데이터는 Firebase 콘솔의 RealtimeDatabase를 통해 확인할 수 있습니다.<br>
만약 앱 알림이 제대로 오지 않는다면, Firebase 콘솔에서 해당 사용자의 token이 제대로 발급되었는지 확인해보세요.<br>
